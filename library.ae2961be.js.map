{"mappings":"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","sources":["src/librari.js","src/js/film-modal-lib.js","src/js/color-change-header-btn.js","src/js/library-render.js"],"sourcesContent":["import './js/pagination';\nimport './js/footerModal';\nimport './js/team-data';\nimport './js/render-team-card';\nimport './js/spinner';\nimport './js/film-modal-lib';\nimport './js/color-change-header-btn';\nimport './js/library-render';","import FilmsApiService from \"./fetch-api\";\nimport { filmModalMarkup } from \"./film-modal-markup\";\nimport {\n    addToStorage,\n    addToStorageWhenNull,\n    removeFromStorage,\n    checkItemInStorage,\n} from './storage';\nimport { inStorageWatched } from \"./storage\";\nimport { inStorageQueue } from \"./storage\";\n\nconst filmsApiService = new FilmsApiService();\nlet id;\nlet markup = \"\";\nconst ADD_TO_WATCHED = 'Add to watched';\nconst ADD_TO_QUEUE = 'Add to queue';\nconst REMOVE_FROM_WATCHED = 'Remove from watched';\nconst REMOVE_FROM_QUEUE = 'Remove from queue';\n\nlet refs = {\n    gallery: document.querySelector(\".library-gallery__list\"),\n    backdrop: document.querySelector(\".modal-backdrop\"),\n    closeFilmModalBtn: \"\",\n    addToWatched: \"\",\n    addToQueue: \"\",\n}\n\ncheckItemInStorage(\"watchedFilms\", \"queueFilms\", []);\nrefs.gallery.addEventListener('click', onOpenFilmModal);\n\nasync function onOpenFilmModal(e) {\n    e.preventDefault();\n    refs.gallery.removeEventListener('click', onOpenFilmModal);\n    id = e.target.dataset.id;\n            \n    if (e.target.nodeName !== 'IMG') {\n      return;\n    }\n    toggleModal();\n    await getFilmModal(id);\n        \n    refs.addToWatched.addEventListener('click', onAddToWatchedClick);\n    refs.addToQueue.addEventListener('click', onAddToQueueClick);\n}\n\nconst getFilmModal = async (filmID) => {\n    try {\n        const data = await filmsApiService.fetchFilmById(filmID);\n        const listOfGenders = await data.genres.map(genre => genre.name).join(', ');\n        const filmData = {...data, listOfGenders};\n        // console.log(filmData);\n        markup = filmModalMarkup(filmData);\n        refs.backdrop.innerHTML = markup;\n        \n        refs.closeFilmModalBtn = document.querySelector(\"[data-modal-close]\");\n        refs.addToWatched = document.querySelector(\".add-to-watched\");\n        refs.addToQueue = document.querySelector(\".add-to-queue\");\n        \n        await onWatchedButtonTextWhenOpenModal(filmID);\n        await onQueueButtonTextWhenOpenModal(filmID);\n        await determineButtonStateWhenOpenModal();\n        \n        refs.closeFilmModalBtn.addEventListener('click', onCloseFilmModal);\n        refs.backdrop.addEventListener('click', onBackdropClose);\n        window.addEventListener('keydown', onEscapeClose);\n\n        return refs.backdrop;\n    }\n\n    catch (error) {\n        console.log(error.message);\n    }\n}\n\nfunction onCloseFilmModal(e) {\n    e.preventDefault();\n    refs.gallery.addEventListener('click', onOpenFilmModal);\n    toggleModal();\n    refs.backdrop.innerHTML = \"\";\n    removeAllEventListeners();\n}\n\nfunction onEscapeClose(e) {\n    e.preventDefault();\n    if (e.code === 'Escape') {\n        refs.gallery.addEventListener('click', onOpenFilmModal);\n        toggleModal();\n        refs.backdrop.innerHTML = \"\";\n        removeAllEventListeners();\n    }\n}\n\nfunction onBackdropClose(e) {\n    e.preventDefault();\n    if (e.currentTarget === e.target) {\n        refs.gallery.addEventListener('click', onOpenFilmModal);\n        toggleModal();\n        refs.backdrop.innerHTML = \"\";\n        removeAllEventListeners();\n    }\n}\n\nfunction toggleModal() {\n    refs.backdrop.classList.toggle(\"is-hidden\");\n}\n\nfunction removeAllEventListeners() {\n    refs.closeFilmModalBtn.removeEventListener('click', onCloseFilmModal);\n    window.removeEventListener('keydown', onEscapeClose);\n    refs.backdrop.removeEventListener('click', onBackdropClose);\n}\n\nfunction onAddToWatchedClick(e) {\n    e.preventDefault();\n    id = e.target.dataset.modalaction;\n    console.log(id);\n    console.log(\"Ви натиснули на кнопку WATCHED, ID цієї картки - \", id);\n    if (localStorage.getItem(\"watchedFilms\") == null) {\n        addToStorageWhenNull(\"watchedFilms\", id);\n    }\n    if (!inStorageWatched(id)) {\n        // отримуємо дані з localStorage, розпарсуємо дані у масив (watchedArray)\n        // додаємо новий id до нього та записуємо до localStorage\n        addToStorage(\"watchedFilms\", id);\n        // змінюємо назву та стан активності кнопок після кліку\n        refs.addToWatched.textContent = REMOVE_FROM_WATCHED;\n        refs.addToWatched.classList.add('is-in-storage');\n    } else {\n        // отримуємо дані з localStorage, розпарсуємо дані у масив (watchedArray)\n        // видаляємо наш id з масиву та записуємо дані до localStorage\n        removeFromStorage(\"watchedFilms\", id);\n        // змінюємо назву та стан активності кнопок після кліку\n        refs.addToWatched.textContent = ADD_TO_WATCHED;\n        refs.addToWatched.classList.remove('is-in-storage');\n    }\n}\n\nfunction onAddToQueueClick(e) {\n    e.preventDefault();\n    console.log(\"Ви натиснули на кнопку QUEUE, ID цієї картки - \", id);\n    if (localStorage.getItem(\"queueFilms\") == null) {\n        addToStorageWhenNull(\"queueFilms\", id);\n    }\n    if (!inStorageQueue(id)) {\n        // отримуємо дані з localStorage, розпарсуємо дані у масив (watchedArray)\n        // додаємо новий id до нього та записуємо до localStorage\n        addToStorage(\"queueFilms\", id);\n        // змінюємо назву та стан активності кнопок після кліку\n        refs.addToQueue.textContent = REMOVE_FROM_QUEUE;\n        refs.addToQueue.classList.add('is-in-storage');\n\n    } else {\n        // отримуємо дані з localStorage, розпарсуємо дані у масив (watchedArray)\n        // видаляємо наш id з масиву та записуємо дані до localStorage\n        removeFromStorage(\"queueFilms\", id);\n        // змінюємо назву та стан активності кнопок після кліку\n        refs.addToQueue.textContent = ADD_TO_QUEUE;\n        refs.addToQueue.classList.remove('is-in-storage');\n    }\n}\n\n// пишемо текст кнопок, коли модалка відкривається\n\nfunction onWatchedButtonTextWhenOpenModal(id) {\n    if(!inStorageWatched(id)) {\n        refs.addToWatched.textContent = ADD_TO_WATCHED;\n        return;\n    }\n    if(inStorageWatched(id)) {\n        refs.addToWatched.textContent = REMOVE_FROM_WATCHED;\n    }\n}\n\nfunction onQueueButtonTextWhenOpenModal(id) {\n    if(!inStorageQueue(id)) {\n        refs.addToQueue.textContent = ADD_TO_QUEUE;\n        return;\n    }\n    if(inStorageQueue(id)) {\n        refs.addToQueue.textContent = REMOVE_FROM_QUEUE;\n    }\n}\n\n// встановлюємо стан активності кнопок при відкритті модалки \n// з урахуванням localStorage\n\nfunction determineButtonStateWhenOpenModal() {\n    if (refs.addToWatched.textContent === ADD_TO_WATCHED) {\n        refs.addToWatched.classList.remove('is-in-storage');\n    } else {\n        refs.addToWatched.classList.add('is-in-storage');\n    }\n    \n    if (refs.addToQueue.textContent === ADD_TO_QUEUE) {\n        refs.addToQueue.classList.remove('is-in-storage');\n    } else {\n        refs.addToQueue.classList.add('is-in-storage');\n    }\n}\n\n","const refs = {\n    headerButtons: document.querySelector('.header__buttons'),\n}\n\nrefs.headerButtons.addEventListener('click', onHeaderBtnClick);\n\nfunction onHeaderBtnClick(e){\n    if(e.target.nodeName !== 'BUTTON'){\n        return\n    }\n\n    const currentActivBtn = document.querySelector('.current__button');\n    const nextActivBtn = e.target;\n    \n    if(currentActivBtn){\n        currentActivBtn.classList.remove('current__button');\n    }\n    nextActivBtn.classList.add('current__button')\n}","import FilmsApiService from './fetch-api';\nimport { load } from './local-storage-service';\nimport { renderLibrary, clearLibraryGallery } from './templates/render-gallery';\n\nconst WATCHED_KEY = 'watchedFilms';\nconst QUEUE_KEY = 'queueFilms';\n\nconst refs = {\n  watchedBtn: document.querySelector('[name=\"watched\"]'),\n  queueBtn: document.querySelector('[name=\"queue\"]')\n}\n\nconst fetchApi = new FilmsApiService();\nconst queueMovies = load(QUEUE_KEY);\nconst watchedMovies = load(WATCHED_KEY);\n\nonWatchedClick();\n\nrefs.watchedBtn.addEventListener('click', onWatchedClick);\nrefs.queueBtn.addEventListener('click', onQueueClick);\n\n\nfunction onWatchedClick() {\n  clearLibraryGallery();\n  watchedMovies.map(movieId =>\n    fetchApi.fetchFilmById(movieId).then(response => {\n      renderLibrary(response);\n    })\n  )\n};\n\nfunction onQueueClick() {\n  clearLibraryGallery();\n  queueMovies.map(movieId =>\n  fetchApi.fetchFilmById(movieId).then(response => {\n  renderLibrary(response);\n  })\n)\n};\n\n\n\n"],"names":["parcelRequire","$52387e607133f895$var$id","$bpxeT","$52387e607133f895$var$filmsApiService","$18yUV","default","$52387e607133f895$var$markup","$52387e607133f895$var$ADD_TO_WATCHED","$52387e607133f895$var$ADD_TO_QUEUE","$52387e607133f895$var$REMOVE_FROM_WATCHED","$52387e607133f895$var$REMOVE_FROM_QUEUE","$52387e607133f895$var$refs","gallery","document","querySelector","backdrop","closeFilmModalBtn","addToWatched","addToQueue","$52387e607133f895$var$onOpenFilmModal","e","$52387e607133f895$var$_onOpenFilmModal","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","preventDefault","removeEventListener","target","dataset","id","nodeName","$52387e607133f895$var$toggleModal","$52387e607133f895$var$getFilmModal","addEventListener","$52387e607133f895$var$onAddToWatchedClick","$52387e607133f895$var$onAddToQueueClick","$jzQFI","checkItemInStorage","filmID","data","listOfGenders","filmData","fetchFilmById","_ctx","sent","genres","map","genre","name","join","$dDDEV","$6D8Ko","filmModalMarkup","innerHTML","$52387e607133f895$var$onWatchedButtonTextWhenOpenModal","$52387e607133f895$var$onQueueButtonTextWhenOpenModal","$52387e607133f895$var$determineButtonStateWhenOpenModal","$52387e607133f895$var$onCloseFilmModal","$52387e607133f895$var$onBackdropClose","window","$52387e607133f895$var$onEscapeClose","console","log","t0","message","$52387e607133f895$var$removeAllEventListeners","code","currentTarget","classList","toggle","modalaction","localStorage","getItem","addToStorageWhenNull","inStorageWatched","removeFromStorage","textContent","remove","addToStorage","add","inStorageQueue","id1","id2","headerButtons","currentActivBtn","nextActivBtn","$f79e75a7cb2d4ae4$var$refs","watchedBtn","queueBtn","$f79e75a7cb2d4ae4$var$fetchApi","$f79e75a7cb2d4ae4$var$queueMovies","$9ekLB","load","$f79e75a7cb2d4ae4$var$watchedMovies","$f79e75a7cb2d4ae4$var$onWatchedClick","$bq49u","clearLibraryGallery","movieId","then","response","renderLibrary"],"version":3,"file":"library.ae2961be.js.map"}